# Feature Flow: Community Tab Functionality
# Tests news, events, and jobs functionality with tab switching

appId: ${APP_ID}
---

# Navigate to community tab
- runFlow: "../core/app_launch.yaml"
- tapOn:
    text: "Topluluk"

# Verify community page
- assertVisible:
    id: "news_event_jobs_view"
- wait: ${timeouts.medium}

# Wait for initial loading
- wait:
    notVisible:
      id: "loading_indicator"
    timeout: ${timeouts.network}

# Test News Tab
- tapOn:
    text: "Haberler"
- wait: ${timeouts.medium}
- assertVisible:
    id: "tab_news_view"
- takeScreenshot: "community_news_tab"

# Wait for news loading
- wait:
    notVisible:
      id: "loading_indicator"
    timeout: ${timeouts.network}

# Test news card interaction
- tapOn:
    when:
      visible:
        id: "news_card"
    id: "news_card"
- wait: ${timeouts.medium}

# If news detail opened
- runFlow:
    when:
      visible:
        id: "news_detail_view"
    file: "./news_detail_interaction.yaml"

# Test Events Tab
- tapOn:
    text: "Etkinlikler"
- wait: ${timeouts.medium}
- assertVisible:
    id: "event_view"
- takeScreenshot: "community_events_tab"

# Wait for events loading
- wait:
    notVisible:
      id: "loading_indicator"
    timeout: ${timeouts.network}

# Test event card interaction
- tapOn:
    when:
      visible:
        id: "event_card"
    id: "event_card"
- wait: ${timeouts.medium}

# If event detail opened
- runFlow:
    when:
      visible:
        id: "event_detail_view"
    file: "./event_detail_interaction.yaml"

# Test Jobs Tab
- tapOn:
    text: "İş İlanı"
- wait: ${timeouts.medium}
- assertVisible:
    id: "tab_jobs_view"
- takeScreenshot: "community_jobs_tab"

# Wait for jobs loading
- wait:
    notVisible:
      id: "loading_indicator"
    timeout: ${timeouts.network}

# Test job card interaction
- tapOn:
    when:
      visible:
        id: "job_card"
    id: "job_card"
- wait: ${timeouts.medium}

# Test filter functionality in community
- tapOn:
    when:
      visible:
        id: "community_filter_button"
    id: "community_filter_button"
- wait: ${timeouts.short}

# If filter sheet opened
- runFlow:
    when:
      visible:
        id: "filter_sheet"
    file: "./community_filter_interaction.yaml"

# Test search functionality in community
- tapOn:
    when:
      visible:
        id: "community_search_button"
    id: "community_search_button"
- wait: ${timeouts.short}

# Input search text
- inputText:
    when:
      visible:
        id: "community_search_field"
    id: "community_search_field"
    text: "kültür"
- wait: ${timeouts.medium}

# Wait for search results
- wait:
    notVisible:
      id: "loading_indicator"
    timeout: ${timeouts.network}

# Clear search
- clearText:
    when:
      visible:
        id: "community_search_field"
    id: "community_search_field"

# Test refresh functionality
- swipeDown
- wait: ${timeouts.medium}

# Wait for refresh to complete
- wait:
    notVisible:
      id: "loading_indicator"
    timeout: ${timeouts.network}
